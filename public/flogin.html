<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOA Hotel - Login Error</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #dbe2f9;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .error-container {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,37,84,0.08), 0 1px 2px rgba(0,0,0,0.04);
            padding: 40px;
            width: 90%;
            max-width: 450px;
            text-align: center;
            animation: slideIn 0.5s ease-out;
            border: 1px solid rgba(0,37,84,0.06);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .error-icon {
            width: 70px;
            height: 70px;
            background: #dc2626;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 32px;
        }
        
        h1 {
            color: #002554;
            margin-bottom: 10px;
            font-size: 22px;
            font-weight: 600;
        }
        
        .error-message {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .language-toggle {
            margin-bottom: 20px;
        }
        
        .lang-btn {
            background: transparent;
            border: 2px solid #002554;
            color: #002554;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
        }
        
        .lang-btn img {
            width: 20px;
            height: 14px;
            object-fit: cover;
            border-radius: 2px;
        }
        
        .lang-btn.active {
            background: #002554;
            color: white;
        }
        
        .lang-btn:hover {
            background: #002554;
            color: white;
        }
        
        .error-details {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .error-code {
            font-family: monospace;
            font-size: 11px;
            color: #888;
            margin-bottom: 8px;
        }
        
        .error-description {
            color: #c62828;
            font-size: 14px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .retry-btn {
            background: #002554;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .retry-btn:hover {
            background: #003d7a;
            transform: translateY(-2px);
        }
        
        .back-btn {
            background: transparent;
            border: 2px solid #002554;
            color: #002554;
            padding: 12px 28px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .back-btn:hover {
            background: #002554;
            color: white;
        }
        
        .help-section {
            background: #f8fafc;
            border: 1px solid rgba(0,37,84,0.08);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        /* Mobile Responsive Styles */
        @media screen and (max-width: 480px) {
            body {
                padding: 10px;
                align-items: flex-start;
                padding-top: 20px;
            }
            
            .error-container {
                padding: 25px 20px;
                width: 100%;
                border-radius: 8px;
            }
            
            .error-icon {
                width: 60px;
                height: 60px;
                font-size: 28px;
                margin-bottom: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .error-message {
                font-size: 13px;
            }
            
            .lang-btn {
                padding: 8px 12px;
                font-size: 12px;
                margin: 0 3px;
            }
            
            .error-details {
                padding: 12px;
            }
            
            .error-description {
                font-size: 13px;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .retry-btn,
            .back-btn {
                width: 100%;
                padding: 14px;
            }
            
            .help-section {
                padding: 15px;
            }
        }
        
        /* Very small screens */
        @media screen and (max-width: 360px) {
            .error-container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .error-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
        }
        
        .help-title {
            font-weight: 600;
            color: #002554;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .help-list {
            color: #666;
            font-size: 13px;
            line-height: 1.7;
        }
        
        .help-list ul {
            margin-left: 20px;
        }
        
        .contact-info {
            color: #888;
            font-size: 12px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-icon">
            ✕
        </div>
        
        <h1 id="error-title">Connection Error</h1>
        
        <div class="language-toggle">
            <button class="lang-btn active" onclick="setLanguage('en')"><img src="assets/images/britain.png" alt="EN"> English</button>
            <button class="lang-btn" onclick="setLanguage('de')"><img src="assets/images/germany.png" alt="DE"> Deutsch</button>
        </div>
        
        <p class="error-message" id="error-message">
            Unable to connect to WiFi. Please check your details and try again.
        </p>
        
        <div class="error-details">
            <div class="error-code" id="error-code">Error Code: AUTH_FAILED</div>
            <div class="error-description" id="error-description">
                The room number or surname provided does not match our reservation records.
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="retry-btn" onclick="retryLogin()" id="retry-btn">Try Again</button>
            <button class="back-btn" onclick="goBack()" id="back-btn">Go Back</button>
        </div>
        
        <div class="help-section">
            <div class="help-title" id="help-title">Need Help?</div>
            <div class="help-list" id="help-content">
                <ul>
                    <li>Make sure your room number is correct (e.g., 101, 205)</li>
                    <li>Use the surname exactly as shown on your reservation</li>
                    <li>Check that you're currently checked in</li>
                    <li>Contact reception if problems persist</li>
                </ul>
            </div>
        </div>
        
        <p class="contact-info" id="contact-info">
            For assistance, please contact the front desk: +49 (0) 123 456 789
        </p>
    </div>
    
    <script>
        const translations = {
            en: {
                errorTitle: "Connection Error",
                errorMessage: "Unable to connect to WiFi. Please check your details and try again.",
                retryBtn: "Try Again",
                backBtn: "Go Back",
                helpTitle: "Need Help?",
                helpContent: `
                    <ul>
                        <li>Make sure your room number is correct (e.g., 101, 205)</li>
                        <li>Use the surname exactly as shown on your reservation</li>
                        <li>Check that you're currently checked in</li>
                        <li>Contact reception if problems persist</li>
                    </ul>
                `,
                contactInfo: "For assistance, please contact the front desk: +49 (0) 123 456 789",
                errors: {
                    'invalid_credentials': 'The room number or surname provided does not match our reservation records.',
                    'device_limit': 'Maximum 3 devices per room can use fast WiFi. This device will be connected with standard speed.',
                    'database_error': 'A technical error occurred. Please try again or contact reception.',
                    'missing_fields': 'Please fill in both room number and surname.',
                    'general_error': 'An unexpected error occurred. Please try again.'
                }
            },
            de: {
                errorTitle: "Verbindungsfehler",
                errorMessage: "WLAN-Verbindung nicht möglich. Bitte überprüfen Sie Ihre Angaben und versuchen Sie es erneut.",
                retryBtn: "Erneut versuchen",
                backBtn: "Zurück",
                helpTitle: "Benötigen Sie Hilfe?",
                helpContent: `
                    <ul>
                        <li>Stellen Sie sicher, dass Ihre Zimmernummer korrekt ist (z.B. 101, 205)</li>
                        <li>Verwenden Sie den Nachnamen genau wie in Ihrer Reservierung</li>
                        <li>Prüfen Sie, ob Sie aktuell eingecheckt sind</li>
                        <li>Kontaktieren Sie die Rezeption bei anhaltenden Problemen</li>
                    </ul>
                `,
                contactInfo: "Für Unterstützung kontaktieren Sie bitte die Rezeption: +49 (0) 123 456 789",
                errors: {
                    'invalid_credentials': 'Die angegebene Zimmernummer oder der Nachname stimmen nicht mit unseren Reservierungsunterlagen überein.',
                    'device_limit': 'Maximal 3 Geräte pro Zimmer können schnelles WLAN nutzen. Dieses Gerät wird mit Standardgeschwindigkeit verbunden.',
                    'database_error': 'Ein technischer Fehler ist aufgetreten. Bitte versuchen Sie es erneut oder kontaktieren Sie die Rezeption.',
                    'missing_fields': 'Bitte füllen Sie sowohl Zimmernummer als auch Nachname aus.',
                    'general_error': 'Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es erneut.'
                }
            }
        };
        
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }
        
        function setLanguage(lang) {
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.lang-btn').classList.add('active');
            
            // Update text content
            const t = translations[lang];
            document.getElementById('error-title').textContent = t.errorTitle;
            document.getElementById('error-message').textContent = t.errorMessage;
            document.getElementById('retry-btn').textContent = t.retryBtn;
            document.getElementById('back-btn').textContent = t.backBtn;
            document.getElementById('help-title').textContent = t.helpTitle;
            document.getElementById('help-content').innerHTML = t.helpContent;
            document.getElementById('contact-info').textContent = t.contactInfo;
            
            // Update error description if error type is known
            const errorType = getUrlParameter('type') || 'general_error';
            if (t.errors[errorType]) {
                document.getElementById('error-description').textContent = t.errors[errorType];
            }
            
            // Update HTML lang attribute
            document.documentElement.lang = lang;
        }
        
        function retryLogin() {
            window.location.href = 'login.html';
        }
        
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'login.html';
            }
        }
        
        // Initialize page with error information
        document.addEventListener('DOMContentLoaded', function() {
            const errorMessage = getUrlParameter('error');
            const errorType = getUrlParameter('type') || '';
            const lang = getUrlParameter('lang') || 'en';
            
            // Check if page was accessed with valid error parameters
            // Must have either an error message or error type from authenticate.php
            if (!errorMessage && !errorType) {
                // Redirect to login page - this page should only be accessed after an error
                window.location.href = 'login.html';
                return;
            }
            
            // Set language
            if (lang === 'de') {
                setLanguage('de');
                document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.lang-btn[onclick*="de"]').classList.add('active');
            }
            
            // Update error code
            const errorCodes = {
                'invalid_credentials': 'AUTH_INVALID_CREDENTIALS',
                'device_limit': 'DEVICE_LIMIT_EXCEEDED', 
                'database_error': 'DATABASE_CONNECTION_ERROR',
                'missing_fields': 'VALIDATION_ERROR',
                'general_error': 'GENERAL_ERROR'
            };
            
            const displayErrorType = errorType || 'general_error';
            document.getElementById('error-code').textContent = `Error Code: ${errorCodes[displayErrorType] || 'UNKNOWN_ERROR'}`;
            
            // Show error description based on type or custom message
            const t = translations[lang];
            if (errorMessage) {
                document.getElementById('error-description').textContent = errorMessage;
            } else if (t.errors[displayErrorType]) {
                document.getElementById('error-description').textContent = t.errors[displayErrorType];
            }
        });
    </script>
</body>
</html>